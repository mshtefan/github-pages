webpackJsonp([1],{0:function(e,t,n){n("j1ja"),e.exports=n("NHnr")},"3dtX":function(e,t,n){"use strict";var r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"#app"}},[t("SurveyForm")],1)},staticRenderFns:[]};t.a=r},"4ixF":function(e,t,n){"use strict";var r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["checkbox_block"===e.field.type?n("CheckboxBlock",{attrs:{id:e.id,field:e.field},on:{"field-valid":function(t){e.emitValidity(!0)},"field-invalid":function(t){e.emitValidity(!1)}}}):e._e(),e._v(" "),"radiobutton_block"===e.field.type?n("RadioButtonBlock",{attrs:{id:e.id,field:e.field},on:{"field-valid":function(t){e.emitValidity(!0)},"field-invalid":function(t){e.emitValidity(!1)}}}):e._e(),e._v(" "),"textfield_block"===e.field.type?n("TextBlock",{attrs:{field:e.field,id:e.id},on:{"field-valid":function(t){e.emitValidity(!0)},"field-invalid":function(t){e.emitValidity(!1)}}}):e._e()],1)},staticRenderFns:[]};t.a=r},"5mQy":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("NYxO");var r=i(n("WnGa"));i(n("wYMm"));function i(e){return e&&e.__esModule?e:{default:e}}t.default={name:"checkboxBlock",extends:r.default,data:function(){return{checkboxesValue:{}}},computed:{isValid:function(){return!this.field.require_at_least_one||this.cleanedPositiveValues.length>0},tagArray:function(){return this.field.assign_tags&&this.isValid?this.cleanedPositiveValues:[]},variableArray:function(){if(this.field.result_variable&&this.isValid){var e={};return e[this.field.result_variable]=this.cleanedPositiveValues.join(", "),e}return{}},cleanedPositiveValues:function(){var e=[];if(0===Object.keys(this.checkboxesValue).length&&this.checkboxesValue.constructor===Object)return e;for(var t in this.checkboxesValue)this.checkboxesValue[t]&&e.push(this.checkboxesValue[t]);return e}}}},"5nG9":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n("NYxO");t.default={name:"successMessage",computed:r({},(0,i.mapGetters)(["successConfig"]))}},"83X0":function(e,t,n){"use strict";var r={render:function(){var e=this.$createElement;return(this._self._c||e)("div")},staticRenderFns:[]};t.a=r},DIJW:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Fiob"),i=n.n(r);for(var a in r)["default","default"].indexOf(a)<0&&function(e){n.d(t,e,function(){return r[e]})}(a);var s=n("xDuP"),u=n("VU/8")(i.a,s.a,!1,null,null,null);t.default=u.exports},"F/oD":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n("NYxO");t.default={name:"errorMessage",computed:r({},(0,i.mapGetters)(["errorConfig"]))}},Fiob:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n("NYxO"),a=l(n("ZaTN")),s=l(n("Vv13")),u=l(n("hedg")),o=l(n("7+uW"));function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"SurveyForm",components:{SurveyBlock:a.default,SuccessMessage:s.default,ErrorMessage:u.default},data:function(){return{fieldsValid:[],surveySubmitted:!1,surveyFinished:!1}},computed:r({isFormValid:function(){return this.fieldsValid.every(function(e,t,n){return e})}},(0,i.mapGetters)(["fields","errors"])),methods:{setValidity:function(e,t){o.default.set(this.fieldsValid,e,t)},submitSurvey:function(){var e=this;this.surveySubmitted=!0,this.$store.dispatch("finishSurvey").then(function(){e.surveyFinished=!0})}}}},HpO2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n("NYxO"),a=o(n("ra7x")),s=o(n("whwf")),u=o(n("X1rh"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"surveyBlock",props:{field:{type:Object,required:!0},id:{required:!0}},components:{CheckboxBlock:a.default,RadioButtonBlock:s.default,TextBlock:u.default},computed:r({},(0,i.mapGetters)([])),data:function(){return{isValid:!1}},methods:{emitValidity:function(e){e?(this.$emit("field-valid"),this.isValid=!0):(this.$emit("field-invalid"),this.isValid=!1)}}}},IcnI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n("7+uW")),i=u(n("NYxO")),a=u(n("fIEj")),s=u(n("bkGr"));function u(e){return e&&e.__esModule?e:{default:e}}r.default.use(i.default),t.default=new i.default.Store({modules:{sailplay:a.default,survey:s.default}})},LguZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n("7+uW")),i=u(n("mtWM")),a=u(n("Rf8U")),s=n("wYMm");function u(e){return e&&e.__esModule?e:{default:e}}var o={init:function(){r.default.use(a.default,i.default),r.default.axios.defaults.baseURL=s.API_URL},query:function(e,t){return r.default.axios.get(e,t).catch(function(e){throw new Error("[sailplay] ApiService "+e)})},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return r.default.axios.get(e+"/"+t).catch(function(e){throw new Error("[sailplay] ApiService "+e)})},post:function(e,t){return r.default.axios.post(""+e,t)},update:function(e,t,n){return r.default.axios.put(e+"/"+t,n)},put:function(e,t){return r.default.axios.put(""+e,t)},delete:function(e){return r.default.axios.delete(e).catch(function(e){throw new Error("[sailplay] ApiService "+e)})}};t.default=o},M93x:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xJD8"),i=n.n(r);for(var a in r)["default","default"].indexOf(a)<0&&function(e){n.d(t,e,function(){return r[e]})}(a);var s=n("3dtX"),u=n("VU/8")(i.a,s.a,!1,null,null,null);t.default=u.exports},NHnr:function(e,t,n){"use strict";var r=o(n("7+uW")),i=o(n("M93x")),a=o(n("IcnI")),s=o(n("qJdI")),u=o(n("LguZ"));function o(e){return e&&e.__esModule?e:{default:e}}r.default.use(s.default),r.default.config.productionTip=!1,u.default.init(),new r.default({el:"#app",store:a.default,template:"<App/>",components:{App:i.default}})},"QdW/":function(e,t,n){"use strict";var r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("img",{attrs:{src:e.successConfig.img}}),e._v(" "),n("h4",[e._v(e._s(e.successConfig.title))]),e._v(" "),n("p",[e._v(e._s(e.successConfig.subtitle))]),e._v(" "),n("a",{attrs:{href:e.successConfig.link}},[e._v(e._s(e.successConfig.button_text))])])},staticRenderFns:[]};t.a=r},Vv13:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("5nG9"),i=n.n(r);for(var a in r)["default","default"].indexOf(a)<0&&function(e){n.d(t,e,function(){return r[e]})}(a);var s=n("QdW/"),u=n("VU/8")(i.a,s.a,!1,null,null,null);t.default=u.exports},WnGa:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("zZI9"),i=n.n(r);for(var a in r)["default","default"].indexOf(a)<0&&function(e){n.d(t,e,function(){return r[e]})}(a);var s=n("83X0"),u=n("VU/8")(i.a,s.a,!1,null,null,null);t.default=u.exports},X1rh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("c9JF"),i=n.n(r);for(var a in r)["default","default"].indexOf(a)<0&&function(e){n.d(t,e,function(){return r[e]})}(a);var s=n("sJhx"),u=n("VU/8")(i.a,s.a,!1,null,null,null);t.default=u.exports},ZaTN:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("HpO2"),i=n.n(r);for(var a in r)["default","default"].indexOf(a)<0&&function(e){n.d(t,e,function(){return r[e]})}(a);var s=n("4ixF"),u=n("VU/8")(i.a,s.a,!1,null,null,null);t.default=u.exports},ZhEA:function(e,t,n){"use strict";var r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",[e._v(" "+e._s(e.field.title)+" ")]),e._v(" "),e._l(e.field.checkboxes,function(t,r){return n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.checkboxesValue[r],expression:"checkboxesValue[key]"}],attrs:{type:"checkbox","true-value":t.value},domProps:{checked:Array.isArray(e.checkboxesValue[r])?e._i(e.checkboxesValue[r],null)>-1:e._q(e.checkboxesValue[r],t.value)},on:{change:function(n){var i=e.checkboxesValue[r],a=n.target,s=!!a.checked&&t.value;if(Array.isArray(i)){var u=e._i(i,null);a.checked?u<0&&e.$set(e.checkboxesValue,r,i.concat([null])):u>-1&&e.$set(e.checkboxesValue,r,i.slice(0,u).concat(i.slice(u+1)))}else e.$set(e.checkboxesValue,r,s)}}}),e._v(" "),n("span",[e._v(e._s(t.title))])])})],2)},staticRenderFns:[]};t.a=r},bENy:function(e,t,n){"use strict";var r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",[e._v(" "+e._s(e.field.title)+" ")]),e._v(" "),e._l(e.field.radiobuttons,function(t,r){return n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.radiobuttonValue,expression:"radiobuttonValue"}],attrs:{type:"radio",name:e.id},domProps:{value:t.value,checked:e._q(e.radiobuttonValue,t.value)},on:{change:function(n){e.radiobuttonValue=t.value}}}),e._v(" "),n("label",{attrs:{for:t.value}},[e._v(e._s(t.title))])])})],2)},staticRenderFns:[]};t.a=r},bkGr:function(e,t,n){"use strict";var r,i;function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var s=(a(r={},"constructSurvey",function(e,t){var n=e.commit,r=e.dispatch,i=e.rootState,a=t.config_name,s=t.partner_id,u=t.auth_hash,o=t.url_params;r("init",{partnerId:s,name:a},{root:!0}).then(function(){return r("authenticateUser",{auth_hash:u},{root:!0})}).then(function(){n("setTitle",i.sailplay.config.title),n("setStyle",i.sailplay.config.style),n("setSuccessConfig",i.sailplay.config.success),n("setErrorConfig",i.sailplay.config.error),n("setCompletionTags",i.sailplay.config.tags_after_completed);var e=[];for(var t in i.sailplay.config.surveys)e=i.sailplay.config.surveys[t].require_tags?e.concat(i.sailplay.config.surveys[t].require_tags):e,e=i.sailplay.config.surveys[t].exclude_tags?e.concat(i.sailplay.config.surveys[t].exclude_tags):e;for(t=0;t<e.length;++t)for(var a=t+1;a<e.length;++a)e[t]===e[a]&&e.splice(a--,1);return r("checkTags",{tags:JSON.stringify(e)})}).then(function(){var e=void 0;for(var t in i.sailplay.config.surveys){var r=i.sailplay.config.surveys[t],a=!0;for(var s in r.require_tags)i.sailplay.tags[r.require_tags[s]]||(a=!1);var u=!0;for(var s in r.exclude_tags)i.sailplay.tags[r.exclude_tags[s]]&&(u=!1);(!r.require_param||o.includes(r.require_param))&&a&&u&&(e=r)}e?(n("setFields",e.fields),e.title&&n("setTitle",e.title),e.tags_after_completed&&n("setCompletionTags",e.tags_after_completed)):n("setErrors",!0,{root:!0})})}),a(r,"assignTags",function(e,t){(0,e.commit)("setResultTagsForId",{id:t.id,tags:t.tags})}),a(r,"assignVariables",function(e,t){(0,e.commit)("setResultVarsForId",{id:t.id,vars:t.vars})}),a(r,"finishSurvey",function(e){e.commit;var t=e.state,n=e.dispatch,r=[];for(var i in t.resultTags)r=r.concat(t.resultTags[i]);for(i=0;i<r.length;++i)for(var a=i+1;a<r.length;++a)r[i]===r[a]&&r.splice(a--,1);var s={};for(var i in t.resultVariables)s=Object.assign({},s,t.resultVariables[i]);n("assignTagsSP",{tags:r.join(",")},{root:!0}).then(function(){n("assignVarsSP",{vars:s},{root:!0})}).then(function(){n("assignTagsSP",{tags:t.completionTags.join(",")},{root:!0})})}),r),u=(a(i={},"setTitle",function(e,t){e.title=t}),a(i,"setStyle",function(e,t){e.style=t}),a(i,"setCompletionTags",function(e,t){e.completionTags=t}),a(i,"setFields",function(e,t){e.fields=t}),a(i,"setResultTagsForId",function(e,t){var n=t.id,r=t.tags;e.resultTags[n]=r}),a(i,"setResultVarsForId",function(e,t){var n=t.id,r=t.vars;e.resultVariables[n]=r}),a(i,"setSuccessConfig",function(e,t){e.successConfig=t}),a(i,"setErrorConfig",function(e,t){e.errorConfig=t}),i);t.default={state:{style:"",title:"",completionTags:"",fields:{},resultTags:{},resultVariables:{},successConfig:{},errorConfig:{}},getters:{title:function(e){return e.title},fields:function(e){return e.fields},successConfig:function(e){return e.successConfig},errorConfig:function(e){return e.errorConfig}},actions:s,mutations:u}},c9JF:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("NYxO");var r,i=n("WnGa"),a=(r=i)&&r.__esModule?r:{default:r};t.default={name:"textBlock",extends:a.default,data:function(){return{inputValue:""}},computed:{variableArray:function(){if(this.isValid){var e={};return e[this.field.result_variable]=this.inputValue,e}return{}},isValid:function(){this.inputValue,this.inputValue.length;return this.inputValue.length>0}}}},fIEj:function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0});var a,s=n("7+uW"),u=(a=s)&&a.__esModule?a:{default:a},o=n("wYMm");function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=(l(r={},"setLang",function(e,t){(0,e.commit)("setLanguage",t.lang)}),l(r,"init",function(e,t){var n=e.commit,r=e.state,i=t.partnerId,a=t.name;return u.default.jsonp(o.API_URL+"/js-api/"+i+"/loyalty-page/config/by-name/",{name:a,lang:r.lang}).then(function(e){e&&e.config?(n("setPartnerId",i),n("setConfig",e.config.config)):n("setErrors",!0)}).catch(function(e){n("setErrors",!0)})}),l(r,"authenticateUser",function(e,t){var n=e.commit,r=e.state,i=t.auth_hash;return u.default.jsonp(o.API_URL+"/js-api/"+r.partnerId+"/users/info",{auth_hash:i,lang:r.lang}).then(function(e){e&&e.user?n("setAuthHash",i):n("setErrors",!0)}).catch(function(e){n("setErrors",!0)})}),l(r,"checkTags",function(e,t){var n=e.commit,r=e.state,i=t.tags;return u.default.jsonp(o.API_URL+"/js-api/"+r.partnerId+"/tags/exist",{auth_hash:r.authHash,tags:i,lang:r.lang}).then(function(e){e&&e.tags?n("setTags",e.tags):n("setErrors",!0)}).catch(function(e){n("setErrors",!0)})}),l(r,"assignTagsSP",function(e,t){var n=e.commit,r=e.state,i=t.tags;return u.default.jsonp(o.API_URL+"/js-api/"+r.partnerId+"/tags/add",{auth_hash:r.authHash,tags:i,lang:r.lang}).then(function(e){e&&"error"!==!e.status||n("setErrors",!0)}).catch(function(e){n("setErrors",!0)})}),l(r,"assignVarsSP",function(e,t){var n=e.commit,r=e.state,i=t.vars;return i.auth_hash=r.authHash,i.lang=r.lang,u.default.jsonp(o.API_URL+"/js-api/"+r.partnerId+"/users/custom-variables/add",i).then(function(e){e&&"error"!==!e.status||n("setErrors",!0)}).catch(function(e){n("setErrors",!0)})}),r),f=(l(i={},"setPartnerId",function(e,t){e.partnerId=t}),l(i,"setConfig",function(e,t){e.config=t}),l(i,"setErrors",function(e,t){e.errors=t}),l(i,"setAuthHash",function(e,t){e.authHash=t}),l(i,"setTags",function(e,t){for(var n in t)e.tags[t[n].name]=t[n].exist}),l(i,"setLanguage",function(e,t){e.lang=t}),i);t.default={state:{partnerId:"",config:{},authHash:"",errors:!1,tags:{},lang:"en"},getters:{errors:function(e){return e.errors}},actions:c,mutations:f}},hGoL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("NYxO");var r,i=n("WnGa"),a=(r=i)&&r.__esModule?r:{default:r};t.default={name:"radiobuttonBlock",extends:a.default,data:function(){return{radiobuttonValue:""}},computed:{isValid:function(){return""!==this.radiobuttonValue},tagArray:function(){return this.field.assign_tags&&this.isValid?[this.radiobuttonValue]:[]},variableArray:function(){if(this.field.result_variable&&this.isValid){var e={};return e[this.field.result_variable]=this.radiobuttonValue,e}return{}}}}},hedg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("F/oD"),i=n.n(r);for(var a in r)["default","default"].indexOf(a)<0&&function(e){n.d(t,e,function(){return r[e]})}(a);var s=n("on1U"),u=n("VU/8")(i.a,s.a,!1,null,null,null);t.default=u.exports},on1U:function(e,t,n){"use strict";var r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h4",[e._v(e._s(e.errorConfig?e.errorConfig.title:"There has been an error"))]),e._v(" "),n("p",[e._v(e._s(e.errorConfig?e.errorConfig.subtitle:"Please contact support"))]),e._v(" "),e.errorConfig?n("a",{attrs:{href:e.errorConfig.link}},[e._v(e._s(e.errorConfig.button_text))]):e._e()])},staticRenderFns:[]};t.a=r},ra7x:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("5mQy"),i=n.n(r);for(var a in r)["default","default"].indexOf(a)<0&&function(e){n.d(t,e,function(){return r[e]})}(a);var s=n("ZhEA"),u=n("VU/8")(i.a,s.a,!1,null,null,null);t.default=u.exports},sJhx:function(e,t,n){"use strict";var r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("br"),e._v(" "),n("span",[e._v(e._s(e.field.title))]),n("br"),e._v(" "),n("span",[e._v(e._s(e.field.answer_title))]),n("br"),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],attrs:{type:"text"},domProps:{value:e.inputValue},on:{input:function(t){t.target.composing||(e.inputValue=t.target.value)}}}),e._v(" "),n("br"),n("br")])},staticRenderFns:[]};t.a=r},wYMm:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={};t.API_URL="https://sailplay.net",t.UNCHECKED_CHECKBOX_HASH="f24e84445c27fdd906c828ce26a69222329235c4"},whwf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("hGoL"),i=n.n(r);for(var a in r)["default","default"].indexOf(a)<0&&function(e){n.d(t,e,function(){return r[e]})}(a);var s=n("bENy"),u=n("VU/8")(i.a,s.a,!1,null,null,null);t.default=u.exports},xDuP:function(e,t,n){"use strict";var r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.surveyFinished||e.errors||!e.fields?e._e():n("div",[e._l(e.fields,function(t,r){return n("SurveyBlock",{attrs:{field:t,id:r},on:{"field-valid":function(t){e.setValidity(r,!0)},"field-invalid":function(t){e.setValidity(r,!1)}}})}),e._v(" "),n("button",{class:{active:e.isFormValid},attrs:{disabled:!e.isFormValid||e.surveySubmitted},on:{click:e.submitSurvey}},[e._v("asda")])],2),e._v(" "),e.surveyFinished&&!e.errors?n("SuccessMessage"):e._e(),e._v(" "),e.errors?n("ErrorMessage"):e._e()],1)},staticRenderFns:[]};t.a=r},xJD8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n("DIJW"));i(n("fIEj"));function i(e){return e&&e.__esModule?e:{default:e}}t.default={name:"App",components:{SurveyForm:r.default},mounted:function(){for(var e=document.getElementById("sailplay-survey-config"),t=JSON.parse(e.innerHTML),n="",r=window.location.search.substring(1).split("&"),i=0;i<r.length;i++){var a=r[i].split("=");"auth_hash"==a[0]&&(n=a[1])}this.$store.dispatch("constructSurvey",{partner_id:t.partner_id,config_name:t.config,auth_hash:n,url_params:r})}}},zZI9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n("bkGr");(r=i)&&r.__esModule;t.default={props:{id:{required:!0},field:{type:Object,required:!0}},computed:{isValid:function(){return!0},tagArray:function(){return[]},variableArray:function(){return{}}},watch:{tagArray:function(e){this.$store.dispatch("assignTags",{id:this.id,tags:e})},variableArray:function(e){this.$store.dispatch("assignVariables",{id:this.id,vars:e})},isValid:function(e){this.emitValidity(e)}},mounted:function(){this.emitValidity(this.isValid)},methods:{emitValidity:function(e){e?this.$emit("field-valid"):this.$emit("field-invalid")}}}}},[0]);